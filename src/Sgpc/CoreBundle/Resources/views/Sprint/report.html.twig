{%  extends 'base.html.twig' %}

{% set lists = sprint.listings %}
{% set remaining = date(sprint.end).diff(date('now')) %}

{% block body %}
    {{ parent() }}

    <div class="container-fluid">
        <h3 class="dashboard-title">
            <a class="back-button" href="{{ path('sgpc_project_scrum', {'id': project.id})}}"><i class="mdi mdi-arrow-left"></i>
            </a>Reporte de sprint

            {% if date('now') > date(sprint.end) or sprint.isActive == false %}
                <span style="float:right;font-size:16px;margin-right: 40px;padding-top: 7px;">
                    Sprint finalizado. {{date(sprint.start)|date('d/m/Y')}} - {{date(story.end)|date('d/m/Y')}}
                </span>
            {% else %}
                <span style="float:right;">
                    {{form(store_form)}}
                </span>
                <span style="float:right;font-size:16px;margin-right: 40px;padding-top: 7px;">
                    <i class="mdi mdi-clock" style="margin-right:5px;"></i>Quedan {{remaining|date('%d días')}}
                </span>
            {% endif %}
        </h3>

        <div class="container">
            
            <div id="chart-container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>

            {{ include('SgpcCoreBundle:Sprint:partials/report_tables.html.twig') }}

        </div>

    </div>

    {# DATOS PARA EL GRAFICO#}


{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        $('document').ready(function () {

        $(function () {
        Highcharts.chart('chart-container', {
        title: {
        text: 'Gráfica Burndown',
                x: - 20 //center
        },
                subtitle: {
                text: '{{sprint.name}}',
                        x: - 20
                },
                xAxis: {
                title: {
                text: 'Duración (Días)'
                },
                        categories:{{ xAxis|json_encode()|raw }},
                        max:{{interval - 1}}
                },
                yAxis: {
                title: {
                text: 'Trabajo (h)'
                },
                        type: 'linear',
                        max:{{ idealHours|json_encode()|raw }},
                        min:0,
                        tickInterval :5

                },
                tooltip: {
                valueSuffix: 'h'
                },
                legend: {
                layout: 'vertical',
                        align: 'right',
                        verticalAlign: 'middle',
                        borderWidth: 0
                },
                series: [{
                name: 'Esfuerzo ideal',
                        data:{{ idealArray|json_encode()|raw }}
                }, {
                name: 'Esfuerzo real',
                        data: {{ realArray|json_encode()|raw }}
                }]
        });
        });
        });
    </script>
{% endblock %}